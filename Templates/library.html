{% extends 'base.html' %}
{% block title %}Library{% endblock %}

{% block extra_css %}
<style>
/* ðŸŒŸ Sidebar */
.sidebar {
  background: rgba(255,255,255,0.07);
  backdrop-filter: blur(15px);
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 15px;
  padding: 15px;
  height: 100%;
  overflow-y: auto;
  box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}

/* ðŸŒŸ Library Card */
.library-card {
  background: rgba(255, 255, 255, 0.1);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 15px;
  padding: 12px;
  margin-bottom: 12px;
  cursor: pointer;
  transition: transform 0.3s ease, box-shadow 0.3s ease, background 0.3s ease;
  backdrop-filter: blur(10px);
  position: relative;
  overflow: hidden;
  color: #f1f1f1;
}

/* Judul */
.library-card h6 {
  font-weight: 600;
  color: #ffffff; /* putih default */
  transition: color 0.3s ease;
}

/* Deskripsi */
.library-card small {
  color: rgba(240,240,240,0.75); /* putih lembut */
  transition: opacity 0.3s ease;
}

/* Hover efek */
.sidebar .library-card:hover h6 {
  color: #ff7f50;
}
.sidebar .library-card:hover small {
  opacity: 0.95;
}

/* Efek hover keseluruhan */
.library-card:hover {
  transform: translateY(-3px);
  box-shadow: 0 8px 25px rgba(255,127,80,0.5), 0 0 15px rgba(255,255,255,0.3);
  background: rgba(255, 255, 255, 0.15);
}
.library-card.active {
  border: 2px solid #ff7f50;
  box-shadow: 0 0 12px rgba(255, 127, 80, 0.6);
}

/* ðŸŒŸ Detail panel */
.detail-panel {
  background: rgba(255,255,255,0.08);
  backdrop-filter: blur(15px);
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: 20px;
  padding: 25px;
  min-height: 400px;
  opacity: 0;
  transform: translateY(20px);
  transition: opacity 0.6s ease, transform 0.6s ease, box-shadow 0.3s ease;
  box-shadow: 0 8px 25px rgba(0,0,0,0.15);
}
.detail-panel.active {
  opacity: 1;
  transform: translateY(0);
}
.detail-panel h3 {
  color: #ff7f50;
  font-weight: bold;
}
.detail-panel p {
  color: #333; /* teks isi lebih gelap agar mudah dibaca */
}

/* Tombol */
#detailPanel .btn-primary {
  background: linear-gradient(90deg, #ff7f50, #ff4500);
  border: none;
  transition: all 0.3s ease;
}
#detailPanel .btn-primary:hover {
  transform: scale(1.05);
  box-shadow: 0 5px 15px rgba(255, 127, 80, 0.5);
}
</style>
{% endblock %}

{% block content %}
<section class="py-5">
  <div class="container-fluid">
    <div class="row">

      <!-- Sidebar kiri -->
      <div class="col-md-4">
        <div class="sidebar">
          {% for library in libraries %}
          <div class="library-card"
               data-title="{{ library.title }}"
               data-description="{{ library.description }}"
               data-type="{{ library.type }}"
               data-file="{{ library.file }}"
               data-link="{{ library.link }}">
            <h6 class="fw-bold mb-1">{{ library.title }}</h6>
            <small class="text-muted">{{ library.description[:40] }}...</small>
          </div>
          {% endfor %}
        </div>
      </div>

      <!-- Panel kanan -->
      <div class="col-md-8">
        <div id="detailPanel" class="detail-panel">
          <h3 id="detailTitle"></h3>
          
          <!-- Container untuk menampilkan gambar atau video -->
          <div id="mediaContainer" class="mb-3">
            <!-- Konten akan diisi dengan JS -->
          </div>
          
          <p id="detailDesc"></p>
          <a id="detailLink" href="#" target="_blank" class="btn btn-primary w-100 mt-2">
            <i class="bi bi-play-circle me-1"></i> Lihat Selengkapnya
          </a>
        </div>
      </div>

    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
<script>
const cards = document.querySelectorAll('.library-card');
const panel = document.getElementById('detailPanel');
const titleEl = document.getElementById('detailTitle');
const descEl = document.getElementById('detailDesc');
const mediaContainer = document.getElementById('mediaContainer');
const linkEl = document.getElementById('detailLink');

let activeCard = null;

cards.forEach(card => {
  card.addEventListener('click', () => {
    if (activeCard === card) {
      card.classList.remove('active');
      panel.classList.remove('active');
      activeCard = null;
      return;
    }

    cards.forEach(c => c.classList.remove('active'));
    card.classList.add('active');
    activeCard = card;

    // Update panel detail
    titleEl.textContent = card.dataset.title;
    descEl.textContent = card.dataset.description;
    linkEl.href = card.dataset.link;

    // Tentukan apakah image atau video
    let type = card.dataset.type;
    let file = card.dataset.file;
    let mediaHTML = '';

    if (type === 'image') {
      mediaHTML = `<img src="{{ url_for('static', filename='image/') }}${file}" class="img-fluid rounded">`;
    } else if (type === 'video') {
      mediaHTML = `<video controls class="img-fluid rounded"><source src="{{ url_for('static', filename='video/') }}${file}" type="video/mp4">Your browser does not support the video tag.</video>`;
    }

    mediaContainer.innerHTML = mediaHTML;

    panel.classList.add('active');
  });
});
</script>
{% endblock %}